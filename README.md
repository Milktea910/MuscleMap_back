# MuscleMap å¾Œç«¯ API

ä¸€å€‹å…¨åŠŸèƒ½çš„å¥èº«è¿½è¹¤æ‡‰ç”¨ç¨‹å¼å¾Œç«¯ APIï¼Œæä¾›ç”¨æˆ¶ç®¡ç†ã€å¥èº«è¨ˆåŠƒã€é‹å‹•è³‡æ–™åº«ã€InBody æ•¸æ“šè¿½è¹¤å’Œæ–‡ç« ç®¡ç†ç­‰åŠŸèƒ½ã€‚

## ğŸ“‹ ç›®éŒ„

- [æŠ€è¡“æ¶æ§‹](#-æŠ€è¡“æ¶æ§‹)
- [åŠŸèƒ½ç‰¹è‰²](#-åŠŸèƒ½ç‰¹è‰²)
- [å®‰è£æŒ‡å—](#-å®‰è£æŒ‡å—)
- [ç’°å¢ƒè®Šæ•¸è¨­å®š](#-ç’°å¢ƒè®Šæ•¸è¨­å®š)
- [API ç«¯é»](#-api-ç«¯é»)
- [è³‡æ–™åº«çµæ§‹](#-è³‡æ–™åº«çµæ§‹)
- [é–‹ç™¼æŒ‡å—](#-é–‹ç™¼æŒ‡å—)
- [éƒ¨ç½²](#-éƒ¨ç½²)

## ğŸ›  æŠ€è¡“æ¶æ§‹

### å¾Œç«¯æŠ€è¡“
- **Node.js** - JavaScript åŸ·è¡Œç’°å¢ƒ
- **Express.js** - Web æ‡‰ç”¨ç¨‹å¼æ¡†æ¶
- **MongoDB** - NoSQL è³‡æ–™åº«
- **Mongoose** - MongoDB ODM

### èº«ä»½é©—è­‰èˆ‡å®‰å…¨
- **Passport.js** - èº«ä»½é©—è­‰ä¸­ä»‹è»Ÿé«”
- **JWT (jsonwebtoken)** - ç„¡ç‹€æ…‹èº«ä»½é©—è­‰
- **bcrypt** - å¯†ç¢¼é›œæ¹ŠåŠ å¯†

### æª”æ¡ˆè™•ç†
- **Multer** - æª”æ¡ˆä¸Šå‚³è™•ç†
- **Cloudinary** - é›²ç«¯åª’é«”ç®¡ç†

### é–‹ç™¼å·¥å…·
- **Nodemon** - è‡ªå‹•é‡å•Ÿé–‹ç™¼ä¼ºæœå™¨
- **ESLint** - ç¨‹å¼ç¢¼å“è³ªæª¢æŸ¥
- **Prettier** - ç¨‹å¼ç¢¼æ ¼å¼åŒ–

## âœ¨ åŠŸèƒ½ç‰¹è‰²

### ğŸ” ç”¨æˆ¶ç³»çµ±
- ç”¨æˆ¶è¨»å†Šèˆ‡ç™»å…¥
- JWT èº«ä»½é©—è­‰èˆ‡æˆæ¬Š
- å€‹äººè³‡æ–™ç®¡ç†
- å¯†ç¢¼åŠ å¯†èˆ‡å®‰å…¨å­˜å„²
- è§’è‰²æ¬Šé™æ§åˆ¶ï¼ˆç”¨æˆ¶/ç®¡ç†å“¡ï¼‰

### ğŸ’ª å¥èº«è¨ˆåŠƒç®¡ç†
- å‰µå»ºå€‹äººåŒ–å¥èº«èª²è¡¨
- ä¸€é€±ä¸ƒå¤©è©³ç´°è¨“ç·´è¦åŠƒ
- èª²è¡¨å…¬é–‹åˆ†äº«æ©Ÿåˆ¶
- æŒ‰è®šèˆ‡æ”¶è—åŠŸèƒ½
- èª²è¡¨æ¨è–¦ç³»çµ±

### ğŸƒ é‹å‹•è³‡æ–™åº«
- è±å¯Œçš„é‹å‹•å‹•ä½œè³‡æ–™åº«
- é‹å‹•å½±ç‰‡èˆ‡èªªæ˜
- é›£åº¦åˆ†ç´šç³»çµ±
- ç›®æ¨™è‚Œç¾¤åˆ†é¡
- å™¨æé¡åˆ¥ç®¡ç†

### ğŸ“Š èº«é«”æ•¸æ“šè¿½è¹¤
- InBody æ•¸æ“šè¨˜éŒ„
- é«”é‡ã€è‚Œè‚‰é‡ã€é«”è„‚è¿½è¹¤
- æ­·å²æ•¸æ“šåœ–è¡¨åˆ†æ
- å€‹äººåŒ–æ•¸æ“šå„€è¡¨æ¿

### ğŸ“° å…§å®¹ç®¡ç†
- å¥èº«æ–‡ç« ç™¼å¸ƒ
- ç²¾é¸å…§å®¹ç®¡ç†
- æ–‡ç« åˆ†é¡èˆ‡æ’åº
- å…§å®¹ SEO å„ªåŒ–

## ğŸš€ å®‰è£æŒ‡å—

### ç³»çµ±éœ€æ±‚
- Node.js >= 18.0.0
- MongoDB >= 5.0
- npm æˆ– yarn

### å®‰è£æ­¥é©Ÿ

1. **è¤‡è£½å°ˆæ¡ˆ**
```bash
git clone https://github.com/Milktea910/MuscleMap_back.git
cd MuscleMap_back
```

2. **å®‰è£ä¾è³´**
```bash
npm install
```

3. **è¨­å®šç’°å¢ƒè®Šæ•¸**
```bash
cp .env.example .env
# ç·¨è¼¯ .env æª”æ¡ˆï¼Œå¡«å…¥å¿…è¦çš„ç’°å¢ƒè®Šæ•¸
```

4. **å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨**
```bash
npm run dev
```

ä¼ºæœå™¨å°‡åœ¨ `http://localhost:4000` ä¸Šé‹è¡Œ

## ğŸ”§ ç’°å¢ƒè®Šæ•¸è¨­å®š

åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„å‰µå»º `.env` æª”æ¡ˆï¼š

```env
# è³‡æ–™åº«é€£ç·š
DB_URL=mongodb://localhost:27017/musclemap

# JWT å¯†é‘°
JWT_SECRET=your_super_secret_key_here

# ä¼ºæœå™¨åŸ è™Ÿ
PORT=4000

# Cloudinary è¨­å®šï¼ˆç”¨æ–¼æª”æ¡ˆä¸Šå‚³ï¼‰
CLOUDINARY_CLOUD_NAME=your_cloud_name
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret
```

## ğŸŒ API ç«¯é»

### ç”¨æˆ¶ç®¡ç† (`/user`)

| æ–¹æ³• | ç«¯é» | æè¿° | æ¬Šé™ |
|------|------|------|------|
| POST | `/user` | ç”¨æˆ¶è¨»å†Š | å…¬é–‹ |
| POST | `/user/login` | ç”¨æˆ¶ç™»å…¥ | å…¬é–‹ |
| GET | `/user/profile` | ç²å–å€‹äººè³‡æ–™ | éœ€è¦èªè­‰ |
| PATCH | `/user/profile` | æ›´æ–°å€‹äººè³‡æ–™ | éœ€è¦èªè­‰ |
| PATCH | `/user/refresh` | åˆ·æ–° JWT | éœ€è¦èªè­‰ |
| DELETE | `/user/logout` | ç”¨æˆ¶ç™»å‡º | éœ€è¦èªè­‰ |
| PATCH | `/user/favorite` | æ·»åŠ æ”¶è—èª²è¡¨ | éœ€è¦èªè­‰ |
| GET | `/user/favorite` | ç²å–æ”¶è—åˆ—è¡¨ | éœ€è¦èªè­‰ |

### å¥èº«èª²è¡¨ (`/routine`)

| æ–¹æ³• | ç«¯é» | æè¿° | æ¬Šé™ |
|------|------|------|------|
| POST | `/routine` | å‰µå»ºèª²è¡¨ | éœ€è¦èªè­‰ |
| GET | `/routine/public` | ç²å–å…¬é–‹èª²è¡¨ | å…¬é–‹ |
| GET | `/routine/my` | ç²å–æˆ‘çš„èª²è¡¨ | éœ€è¦èªè­‰ |
| GET | `/routine/liked` | ç²å–æŒ‰è®šèª²è¡¨ | éœ€è¦èªè­‰ |
| PATCH | `/:id` | æ›´æ–°èª²è¡¨ | éœ€è¦èªè­‰ |
| DELETE | `/:id` | åˆªé™¤èª²è¡¨ | éœ€è¦èªè­‰ |
| POST | `/:id/like` | åˆ‡æ›æŒ‰è®šç‹€æ…‹ | éœ€è¦èªè­‰ |
| PATCH | `/:id/visibility` | æ›´æ–°å…¬é–‹ç‹€æ…‹ | éœ€è¦èªè­‰ |

### é‹å‹•è³‡æ–™åº« (`/exercise`)

| æ–¹æ³• | ç«¯é» | æè¿° | æ¬Šé™ |
|------|------|------|------|
| GET | `/exercise` | ç²å–æ‰€æœ‰é‹å‹• | å…¬é–‹ |
| GET | `/:id` | ç²å–å–®å€‹é‹å‹• | å…¬é–‹ |
| POST | `/exercise` | å‰µå»ºé‹å‹• | ç®¡ç†å“¡ |
| PATCH | `/:id` | æ›´æ–°é‹å‹• | ç®¡ç†å“¡ |
| DELETE | `/:id` | åˆªé™¤é‹å‹• | ç®¡ç†å“¡ |

### InBody æ•¸æ“š (`/inbody`)

| æ–¹æ³• | ç«¯é» | æè¿° | æ¬Šé™ |
|------|------|------|------|
| POST | `/inbody` | å‰µå»ºæ•¸æ“šè¨˜éŒ„ | éœ€è¦èªè­‰ |
| GET | `/inbody` | ç²å–æ‰€æœ‰è¨˜éŒ„ | éœ€è¦èªè­‰ |
| GET | `/inbody/profile` | ç²å–æœ€æ–°è¨˜éŒ„ | éœ€è¦èªè­‰ |
| GET | `/:id` | ç²å–å–®ç­†è¨˜éŒ„ | éœ€è¦èªè­‰ |
| PUT | `/:id` | æ›´æ–°è¨˜éŒ„ | éœ€è¦èªè­‰ |
| DELETE | `/:id` | åˆªé™¤è¨˜éŒ„ | éœ€è¦èªè­‰ |

### æ–‡ç« ç®¡ç† (`/article`)

| æ–¹æ³• | ç«¯é» | æè¿° | æ¬Šé™ |
|------|------|------|------|
| GET | `/article/featured` | ç²å–ç²¾é¸æ–‡ç«  | å…¬é–‹ |
| GET | `/article` | ç²å–æ‰€æœ‰æ–‡ç«  | å…¬é–‹ |
| GET | `/:id` | ç²å–å–®ç¯‡æ–‡ç«  | å…¬é–‹ |
| POST | `/article` | å‰µå»ºæ–‡ç«  | ç®¡ç†å“¡ |
| PATCH | `/:id` | æ›´æ–°æ–‡ç«  | ç®¡ç†å“¡ |
| DELETE | `/:id` | åˆªé™¤æ–‡ç«  | ç®¡ç†å“¡ |

## ğŸ—„ è³‡æ–™åº«çµæ§‹

### User (ç”¨æˆ¶)
```javascript
{
  account: String,          // å¸³è™Ÿ
  username: String,         // ä½¿ç”¨è€…åç¨±
  email: String,           // é›»å­éƒµä»¶
  password: String,        // åŠ å¯†å¯†ç¢¼
  gender: String,          // æ€§åˆ¥
  role: String,            // è§’è‰² (user/admin)
  favorites: Array,        // æ”¶è—èª²è¡¨
  tokens: Array           // JWT tokens
}
```

### Routine (å¥èº«èª²è¡¨)
```javascript
{
  user: ObjectId,          // ç”¨æˆ¶ ID
  title: String,           // èª²è¡¨æ¨™é¡Œ
  content: String,         // èª²è¡¨æè¿°
  weeklyPlan: Array,       // ä¸€é€±è¨“ç·´è¨ˆåŠƒ
  workouts: Array,         // é‹å‹•åˆ—è¡¨ï¼ˆèˆŠç‰ˆç›¸å®¹ï¼‰
  isPublic: Boolean,       // æ˜¯å¦å…¬é–‹
  likes: Array,            // æŒ‰è®šç”¨æˆ¶
  likesCount: Number       // æŒ‰è®šæ•¸é‡
}
```

### Exercise (é‹å‹•)
```javascript
{
  name: String,            // é‹å‹•åç¨±
  equipment: String,       // å™¨æé¡å‹
  difficulty: String,      // é›£åº¦ç­‰ç´š
  targetMuscle: Array,     // ç›®æ¨™è‚Œç¾¤
  video: String,           // æ•™å­¸å½±ç‰‡
  notes: Array            // æ³¨æ„äº‹é …
}
```

### InBody (èº«é«”æ•¸æ“š)
```javascript
{
  user: ObjectId,          // ç”¨æˆ¶ ID
  weight: Number,          // é«”é‡
  muscleMass: Number,      // è‚Œè‚‰é‡
  fat: Number,             // é«”è„‚é‡
  bmi: Number,             // BMI
  recordDate: Date         // è¨˜éŒ„æ—¥æœŸ
}
```

### Article (æ–‡ç« )
```javascript
{
  title: String,           // æ–‡ç« æ¨™é¡Œ
  description: String,     // æ–‡ç« æè¿°
  author: String,          // ä½œè€…
  image: String,           // æ–‡ç« åœ–ç‰‡
  link: String,            // å¤–éƒ¨é€£çµ
  buttonText: String,      // æŒ‰éˆ•æ–‡å­—
  isFeatured: Boolean,     // æ˜¯å¦ç²¾é¸
  isActive: Boolean,       // æ˜¯å¦å•Ÿç”¨
  order: Number           // æ’åº
}
```

## ğŸ‘¨â€ğŸ’» é–‹ç™¼æŒ‡å—

### å°ˆæ¡ˆçµæ§‹
```
MuscleMap_back/
â”œâ”€â”€ controllers/         # æ§åˆ¶å™¨é‚è¼¯
â”‚   â”œâ”€â”€ user.js
â”‚   â”œâ”€â”€ routine.js
â”‚   â”œâ”€â”€ exercise.js
â”‚   â”œâ”€â”€ inbody.js
â”‚   â””â”€â”€ article.js
â”œâ”€â”€ models/             # è³‡æ–™æ¨¡å‹
â”‚   â”œâ”€â”€ user.js
â”‚   â”œâ”€â”€ routine.js
â”‚   â”œâ”€â”€ exercise.js
â”‚   â”œâ”€â”€ inbody.js
â”‚   â””â”€â”€ article.js
â”œâ”€â”€ routes/             # è·¯ç”±å®šç¾©
â”‚   â”œâ”€â”€ user.js
â”‚   â”œâ”€â”€ routine.js
â”‚   â”œâ”€â”€ exercise.js
â”‚   â”œâ”€â”€ inbody.js
â”‚   â””â”€â”€ article.js
â”œâ”€â”€ middlewares/        # ä¸­ä»‹è»Ÿé«”
â”‚   â”œâ”€â”€ auth.js         # èº«ä»½é©—è­‰
â”‚   â””â”€â”€ upload.js       # æª”æ¡ˆä¸Šå‚³
â”œâ”€â”€ index.js           # æ‡‰ç”¨ç¨‹å¼å…¥å£
â”œâ”€â”€ passport.js        # Passport è¨­å®š
â””â”€â”€ package.json       # å°ˆæ¡ˆè¨­å®š
```

### é–‹ç™¼æŒ‡ä»¤
```bash
# é–‹ç™¼æ¨¡å¼ï¼ˆè‡ªå‹•é‡å•Ÿï¼‰
npm run dev

# ç¨‹å¼ç¢¼æª¢æŸ¥
npx eslint .

# ç¨‹å¼ç¢¼æ ¼å¼åŒ–
npx prettier --write .
```

### API å›æ‡‰æ ¼å¼

#### æˆåŠŸå›æ‡‰
```json
{
  "success": true,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {...}
}
```

#### éŒ¯èª¤å›æ‡‰
```json
{
  "success": false,
  "message": "éŒ¯èª¤è¨Šæ¯"
}
```

### èº«ä»½é©—è­‰

ä½¿ç”¨ JWT Bearer Tokenï¼š
```
Authorization: Bearer <your_jwt_token>
```

## ğŸš€ éƒ¨ç½²

### ç’°å¢ƒæº–å‚™
1. æº–å‚™ MongoDB è³‡æ–™åº«ï¼ˆMongoDB Atlas æ¨è–¦ï¼‰
2. è¨­å®š Cloudinary å¸³è™Ÿ
3. æº–å‚™ Node.js hosting æœå‹™

### éƒ¨ç½²æ­¥é©Ÿ
1. è¨­å®šç”Ÿç”¢ç’°å¢ƒè®Šæ•¸
2. æ§‹å»ºä¸¦ä¸Šå‚³ç¨‹å¼ç¢¼
3. å®‰è£ä¾è³´ï¼š`npm install --production`
4. å•Ÿå‹•æ‡‰ç”¨ï¼š`node index.js`

### å»ºè­°çš„ç’°å¢ƒ
- **Heroku**
- **Railway**
- **Render**
- **AWS EC2**
- **Google Cloud Platform**

## ğŸ“ æˆæ¬Š

æœ¬å°ˆæ¡ˆæ¡ç”¨ ISC æˆæ¬Šæ¢æ¬¾ã€‚

## ğŸ¤ è²¢ç»

æ­¡è¿æäº¤ Issue å’Œ Pull Request ä¾†æ”¹å–„é€™å€‹å°ˆæ¡ˆï¼

## ğŸ“ è¯çµ¡è³‡è¨Š

å¦‚æœ‰ä»»ä½•å•é¡Œï¼Œè«‹è¯çµ¡é–‹ç™¼åœ˜éšŠæˆ–åœ¨ GitHub ä¸Šé–‹å•Ÿ Issueã€‚

---

ç”± MuscleMap é–‹ç™¼åœ˜éšŠç”¨ â¤ï¸ è£½ä½œ
